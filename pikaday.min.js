/*!
 * Pikaday
 * Copyright Â© 2012 David Bushell | BSD & MIT license | http://dbushell.com/
 */
(function(j,r,q){var s="function"===typeof j.moment,t=!!j.addEventListener,u=j.setTimeout,m=function(a,b,c,d){t?a.addEventListener(b,c,!!d):a.attachEvent("on"+b,c)},l=function(a,b,c,d){t?a.removeEventListener(b,c,!!d):a.detachEvent("on"+b,c)},f=function(a,b){return-1!==(" "+a.className+" ").indexOf(" "+b+" ")},v=function(a){return/Array/.test(Object.prototype.toString.call(a))},k=function(a){return/Date/.test(Object.prototype.toString.call(a))&&!isNaN(a.getTime())},w=function(a,b,c){var d,e;for(d in b)if((e= a[d]!==q)&&"object"===typeof b[d]&&b[d].nodeName===q)k(b[d])?c&&(a[d]=new Date(b[d].getTime())):v(b[d])?c&&(a[d]=b[d].slice(0)):a[d]=w({},b[d],c);else if(c||!e)a[d]=b[d];return a},x={field:null,calbutton:null,bound:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,useTime:!1,useSecs:!1,confirm:!1,formatPreset:0,minDate:null,maxDate:null,yearRange:10,minYear:0,maxYear:9999,minMonth:q,maxMonth:q,isRTL:!1,numberOfMonths:1,i18n:{months:"January February March April May June July August September October November December".split(" "), weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" ")},onSelect:null,onOpen:null,onClose:null},y=function(a,b,c){for(b+=a.firstDay;7<=b;)b-=7;return c?a.i18n.weekdaysShort[b]:a.i18n.weekdays[b]},z=function(a,b,c,d,e){if(e)return'<td class="is-empty"></td>';e=[];d&&e.push("is-disabled");c&&e.push("is-today");b&&e.push("is-selected");return'<td data-day="'+a+'" class="'+e.join(" ")+'"><button class="pika-button" type="button">'+ a+"</button></td>"};j.Pikaday=function(a){var b=this,c=b.config(a);b._onMouseDown=function(a){if(b._v){var a=a||j.event,e=a.target||a.srcElement;if(e){if(!f(e,"is-disabled")){if(f(e,"pika-button")&&!f(e,"is-empty"))if(b._da=parseInt(e.innerHTML,10),b.draw(),c.confirm)b._c=!0;else{b.setDate(new Date(b._y,b._m,b._da,b._h,b._mi,b._s));c.bound&&!c.useTime&&u(function(){b.hide()},100);return}else f(e,"pika-year-prev")?b.prevYear():f(e,"pika-year-next")?b.nextYear():f(e,"pika-prev")?b.prevMonth():f(e,"pika-next")? b.nextMonth():f(e,"pika-hour-prev")?b.prevHour():f(e,"pika-hour-next")?b.nextHour():f(e,"pika-minute-prev")?b.prevMinute():f(e,"pika-minute-next")?b.nextMinute():f(e,"pika-second-prev")?b.prevSecond():f(e,"pika-second-next")?b.nextSecond():f(e,"pika-confirm-button")&&(b.setDate(new Date(b._y,b._m,b._da,b._h,b._mi,b._s)),c.bound&&u(function(){b.hide()},100));!c.confirm&&!f(e,"pika-select")&&b.setDate(new Date(b._y,b._m,b._da,b._h,b._mi,b._s))}if(f(e,"pika-select"))b._c=!0;else if(a.preventDefault)a.preventDefault(); else return a.returnValue=!1}}};b._onChange=function(a){a=a||j.event;(a=a.target||a.srcElement)&&(f(a,"pika-select-year")?b.gotoYear(a.value):f(a,"pika-select-month")?b.gotoMonth(a.value):f(a,"pika-select-hour")?b.gotoHour(a.value):f(a,"pika-select-minute")?b.gotoMinute(a.value):f(a,"pika-select-second")&&b.gotoSecond(a.value))};b._onInputChange=function(){if(!b._v){var a;1==b._o.formatPreset?(a=new Date(Date.parse(c.field.value.substr(0,10))),a.setHours(c.field.value.substr(11,2)),a.setMinutes(c.field.value.substr(14, 2)),a.setSeconds(c.field.value.substr(17,2))):a=new Date(Date.parse(c.field.value));b.setDate(k(a)?a:null);b.show()}};b._onInputFocus=function(){b.show()};b._onInputClick=function(){b.show()};b._onInputBlur=function(){!b._c&&!b._o.calbutton&&(b._b=u(function(){b.hide()},50));b._c=!1};b._onClick=function(a){var a=a||j.event,e=a=a.target||a.srcElement;if(a){f(a,"pika-select")&&(!t&&!a.onchange)&&(a.setAttribute("onchange","return;"),m(a,"change",b._onChange));do if(f(e,"pika-single"))return;while(e= e.parentNode);if(b._v&&a!==(c.calbutton?c.calbutton:c.field))b._o.confirm?"":b.setDate(new Date(b._y,b._m,b._da,b._h,b._mi,b._s)),b.hide()}};b.el=r.createElement("div");b.el.className="pika-single"+(c.isRTL?" is-rtl":"");m(b.el,"mousedown",b._onMouseDown,!0);m(b.el,"change",b._onChange);c.field&&(c.bound?r.body.appendChild(b.el):c.field.parentNode.insertBefore(b.el,c.field.nextSibling),m(c.field,"change",b._onInputChange),c.defaultDate||(c.defaultDate=s&&c.field.value?j.moment(c.field.value,c.format).toDate(): new Date(Date.parse(c.field.value)),c.setDefaultDate=!0));a=c.defaultDate;k(a)?c.setDefaultDate?b.setDate(a):b.gotoDate(a):b.gotoDate(new Date);c.bound?(this.hide(),b.el.className+=" is-bound",c.calbutton?m(c.calbutton,"click",b._onInputClick):(m(c.field,"click",b._onInputClick),m(c.field,"focus",b._onInputFocus)),m(c.field,"blur",b._onInputBlur)):this.show()};j.Pikaday.prototype={config:function(a){this._o||(this._o=w({},x,!0));a=w(this._o,a,!0);a.isRTL=!!a.isRTL;a.field=a.field&&a.field.nodeName? a.field:null;a.calbutton=a.calbutton&&a.calbutton.nodeName?a.calbutton:null;a.bound=!!(a.bound!==q?a.field&&a.bound:a.field);var b=parseInt(a.numberOfMonths,10)||1;a.numberOfMonths=4<b?4:b;k(a.minDate)||(a.minDate=!1);k(a.maxDate)||(a.maxDate=!1);a.minDate&&a.maxDate&&a.maxDate<a.minDate&&(a.maxDate=a.minDate=!1);a.minDate&&(a.minYear=a.minDate.getFullYear(),a.minMonth=a.minDate.getMonth());a.maxDate&&(a.maxYear=a.maxDate.getFullYear(),a.maxMonth=a.maxDate.getMonth());v(a.yearRange)?(b=(new Date).getFullYear()- 10,a.yearRange[0]=parseInt(a.yearRange[0],10)||b,a.yearRange[1]=parseInt(a.yearRange[1],10)||b):(a.yearRange=Math.abs(parseInt(a.yearRange,10))||x.yearRange,100<a.yearRange&&(a.yearRange=100));return a},toString:function(a){var b=null;k(this._d)&&(s?b=j.moment(this._d).format(a||this._o.format):0==this._o.formatPreset?(b=this._d.toDateString(),this._o.useTime&&(b+=" "+this._d.toTimeString().substr(0,5),this._o.useSecs&&(b+=this._d.toTimeString().substr(5,3)))):1==this._o.formatPreset?(this._d.toISOString? b=this._d.toISOString().substr(0,10):(month=this._d.getMonth()+1,day=this._d.getDate(),b=this._d.getFullYear()+"-",b+=(10>month?"0"+month:month)+"-",b+=10>day?"0"+day:day),this._o.useTime&&(b+=" "+this._d.toTimeString().substr(0,5),this._o.useSecs&&(b+=this._d.toTimeString().substr(5,3)))):"undefined"==typeof console?alert("Error: formatPreset: Not a preset"):console.error("Error: formatPreset: Not a preset"));return b},getMoment:function(){return s?j.moment(this._d):null},getDate:function(){return k(this._d)? new Date(this._d.getTime()):null},setDate:function(a){if(!a)return this._d=null,this.draw();"string"===typeof a&&(a=new Date(Date.parse(a.toString())));if(k(a)){var b=this._o.minDate,c=this._o.maxDate;k(b)&&a<b?a=b:k(c)&&a>c&&(a=c);this._d=new Date(a.getTime());this.gotoDate(this._d);this._o.field&&(this._o.field.value=this.toString());"function"===typeof this._o.onSelect&&this._o.onSelect.call(this,this.getDate())}},gotoDate:function(a){k(a)&&(this._y=a.getFullYear(),this._m=a.getMonth(),this._da= a.getDate(),this._h=a.getHours(),this._mi=a.getMinutes(),this._s=a.getSeconds(),this.draw())},gotoToday:function(){this.gotoDate(new Date)},nextYear:function(){this._y++;this.draw()},prevYear:function(){this._y--;this.draw()},nextMonth:function(){11<++this._m&&(this._m=0,this._y++);this.draw()},prevMonth:function(){0>--this._m&&(this._m=11,this._y--);this.draw()},nextHour:function(){23<++this._h&&(this._h=0,this._m++);this.draw()},prevHour:function(){0>--this._h&&(this._h=23,this._m--);this.draw()}, nextMinute:function(){59<++this._mi&&(this._mi=0,this._h++);this.draw()},prevMinute:function(){0>--this._mi&&(this._mi=59,this._h--);this.draw()},nextSecond:function(){59<++this._s&&(this._s=0,this._mi++);this.draw()},prevSecond:function(){0>--this._s&&(this._s=59,this._mi--);this.draw()},gotoYear:function(a){isNaN(a)||(this._y=parseInt(a,10),this.draw())},gotoMonth:function(a){if(!isNaN(a=parseInt(a,10)))this._m=0>a?0:11<a?11:a,this.draw()},gotoHour:function(a){isNaN(a)||(this._h=parseInt(a,10), this.draw())},gotoMinute:function(a){isNaN(a)||(this._mi=parseInt(a,10),this.draw())},gotoSecond:function(a){isNaN(a)||(this._s=parseInt(a,10),this.draw())},draw:function(a){if(this._v||a){var a=this._o,b=a.minYear,c=a.maxYear,d=a.minMonth,e=a.maxMonth;this._y<=b&&(this._y=b,!isNaN(d)&&this._m<d&&(this._m=d));this._y>=c&&(this._y=c,!isNaN(e)&&this._m>e&&(this._m=e));for(var b=this.el,f=this._o,h=this._m,n=this._y,p=n===f.minYear,g=n===f.maxYear,i='<div class="pika-title">',j=!0,k=!0,m=!0,l=!0,e=[], c=0;12>c;c++)e.push('<option value="'+c+'"'+(c===h?" selected":"")+(p&&c<f.minMonth||g&&c>f.maxMonth?"disabled":"")+">"+f.i18n.months[c]+"</option>");i+='<div class="pika-label">'+f.i18n.months[h]+'<select class="pika-select pika-select-month">'+e.join("")+"</select></div>";v(f.yearRange)?(c=f.yearRange[0],d=f.yearRange[1]+1):(c=n-f.yearRange,d=1+n+f.yearRange);for(e=[];c<d&&c<=f.maxYear;c++)c>=f.minYear&&e.push('<option value="'+c+'"'+(c===n?" selected":"")+">"+c+"</option>");i+='<div class="pika-label">'+ n+'<select class="pika-select pika-select-year">'+e.join("")+"</select></div>";if(p&&(j=!1,0===h||f.minMonth>=h))m=!1;if(g&&(k=!1,11===h||f.maxMonth<=h))l=!1;i=i+('<button class="pika-year-prev'+(j?"":" is-disabled")+'" type="button">Previous Year</button>')+('<button class="pika-year-next'+(k?"":" is-disabled")+'" type="button">Next Year</button>');i+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">Previous Month</button>';i+='<button class="pika-next'+(l?"":" is-disabled")+'" type="button">Next Month</button>'; c=i+"</div>"+this.render(this._y,this._m,this._da);if(a.useTime){f=this._o;h=this._s;n=this._mi;p=this._h;g='<div class="pika-time">';l=m=k=j=i=!0;0===p&&(i=!1,0===n&&(k=!1,0===h&&(k=!1)));23===p&&(j=!1,59===n&&(m=!1,59===h&&(l=!1)));e=[];for(d=0;24>d;d+=2)d?e.push('<option value="'+(d-2)+'"'+(d-2===p?" selected":"")+">"+(10<=d-2?d-2:"0"+(d-2))+"</option>"):(e.push('<option value="default" '+(p%2||"undefined"==p?"selected ":"")+"disabled>Select Hour:</option>"),self._w=!1);g=g+('<button class="pika-hour-prev'+ (i?"":" is-disabled")+'" type="button">Previous Hour</button>')+('<div class="pika-label-time">'+(10<=p?p:"0"+p)+'<select class="pika-select pika-select-hour">'+e.join("")+"</select></div>");g+='<button class="pika-hour-next'+(j?"":" is-disabled")+'" type="button">Next Hour</button>';e=[];for(d=0;60>d;d+=5)d?e.push('<option value="'+(d-5)+'"'+(d-5===n?" selected":"")+">"+(10<=d-5?d-5:"0"+(d-5))+"</option>"):e.push('<option value="default" '+(n%5||"undefined"==n?"selected ":"")+"disabled>Select Minutes:</option>"); g+='<div class="pika-label-time">:</div>';g+='<button class="pika-minute-prev'+(k?"":" is-disabled")+'" type="button">Previous Minute</button>';g+='<div class="pika-label-time">'+(10<=n?n:"0"+n)+'<select class="pika-select pika-select-minute">'+e.join("")+"</select></div>";g+='<button class="pika-minute-next'+(m?"":" is-disabled")+'" type="button">Next Minute</button>';if(f.useSecs){e=[];for(d=0;60>d;d+=5)d?e.push('<option value="'+(d-5)+'"'+(d-5===h?" selected":"")+">"+(10<=d-5?d-5:"0"+(d-5))+"</option>"): e.push('<option value="default" '+(h%5||"undefined"==h?"selected ":"")+"disabled>Select Seconds:</option>");g+='<div class="pika-label-time">:</div>';g+='<button class="pika-second-prev'+(l?"":" is-disabled")+'" type="button">Previous Second</button>';g+='<div class="pika-label-time">'+(10<=h?h:"0"+h)+'<select class="pika-select pika-select-second">'+e.join("")+"</select></div>";g+='<button class="pika-second-next" type="button">Next second</button>'}d=g+"</div>"}else d="";b.innerHTML=c+d+(a.confirm? '<div class="pika-confirm""><button class="pika-confirm-button" type="button">OK</button></div>':"");if(a.bound){a=a.field;b=a.offsetLeft;for(c=a.offsetTop+a.offsetHeight;a=a.offsetParent;)b+=a.offsetLeft,c+=a.offsetTop;this.el.style.cssText="position:absolute;left:"+b+"px;top:"+c+"px;"}}},render:function(a,b,c){var d=this._o,e=new Date,f=[31,0===a%4&&0!==a%100||0===a%400?29:28,31,30,31,30,31,31,30,31,30,31][b],h=(new Date(a,b,1)).getDay(),k=[],j=[];e.setHours(0,0,0,0);0<d.firstDay&&(h-=d.firstDay, 0>h&&(h+=7));for(var g=f+h,i=g;7<i;)i-=7;for(var g=g+(7-i),m=i=0;i<g;i++){var l=new Date(a,b,1+(i-h)),q=d.minDate&&l<d.minDate||d.maxDate&&l>d.maxDate,r=i===c-1+h?!0:!1,l=l.getTime()===e.getTime();j.push(z(1+(i-h),r,l,q,i<h||i>=f+h));7===++m&&(k.push("<tr>"+(d.isRTL?j.reverse():j).join("")+"</tr>"),j=[],m=0)}b=[];for(a=0;7>a;a++)b.push('<th scope="col"><abbr title="'+y(d,a)+'">'+y(d,a,!0)+"</abbr></th>");return'<table cellpadding="0" cellspacing="0" class="pika-table">'+("<thead>"+(d.isRTL?b.reverse(): b).join("")+"</thead>")+("<tbody>"+k.join("")+"</tbody>")+"</table>"},isVisible:function(){return this._v},show:function(){if(!this._v){if(s)self.setDate(j.moment(opts.field.value,opts.format).toDate());else{var a;this._o.field.value&&(1==this._o.formatPreset?(this._y=parseInt(this._o.field.value.substr(0,4),10),this._m=parseInt(this._o.field.value.substr(5,2),10)-1,this._da=parseInt(this._o.field.value.substr(8,2),10),this._o.useTime&&(this._h=parseInt(this._o.field.value.substr(11,2),10),this._mi= parseInt(this._o.field.value.substr(14,2),10),this._o.useSecs&&(this._s=parseInt(this._o.field.value.substr(17,2),10))),a=new Date(this._y,this._m,this._da,this._h,this._mi,this._s)):a=new Date(Date.parse(this._o.field.value)),this.setDate(k(a)?a:null))}this._o.bound&&m(r,"click",this._onClick);a=this.el;var b;b=(" "+a.className+" ").replace(" is-hidden "," ");b=b.trim?b.trim():b.replace(/^\s+|\s+$/g,"");a.className=b;this._v=!0;this.draw();"function"===typeof this._o.onOpen&&this._o.onOpen.call(this)}}, hide:function(){var a=this._v;if(!1!==a){this._o.bound&&l(r,"click",this._onClick);this.el.style.cssText="";var b=this.el;f(b,"is-hidden")||(b.className=""===b.className?"is-hidden":b.className+" is-hidden");this._v=!1;a!==q&&"function"===typeof this._o.onClose&&this._o.onClose.call(this)}},destroy:function(){this.hide();l(this.el,"mousedown",this._onMouseDown,!0);l(this.el,"change",this._onChange);this._o.field&&(l(this._o.field,"change",this._onInputChange),this._o.bound&&(opts.calbutton?l(this._o.calbutton, "click",this._onInputClick):(l(this._o.field,"click",this._onInputClick),l(this._o.field,"focus",this._onInputFocus)),l(this._o.field,"blur",this._onInputBlur)));this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}})(window,window.document);
